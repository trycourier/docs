---
sidebar_position: 4
---

# Microsoft Teams

<head>
  <link
    rel="canonical"
    href="https://www.courier.com/docs/guides/getting-started/microsoft-teams/"
  />
</head>

## Microsoft Teams Bot Requirements

To send notifications via Microsoft Teams, a Microsoft Teams Bot is required. You may use an existing or [create a new one](https://docs.microsoft.com/en-us/microsoftteams/platform/build-your-first-app/build-bot).

## Profile Requirements

With Microsoft Teams, Courier can send a message to either Users that are part of a tenant or the Channel.

To locate your `tenant_id`, you can navigate to https://teams.microsoft.com/?tenantId and copy the value from the redirected url `tennantId` query parameter.

### Send a message to a Microsoft Teams User

To deliver a message to a recipient over Microsoft Teams, Courier must be provided with the ID of the intended recipient, the tenant ID for the Microsoft Teams account that recipient is a user of, and the service URL associated with that Microsoft Teams tenant.

You can use the [Microsoft Graph Explorer](https://developer.microsoft.com/en-us/graph/graph-explorer) to query for the `user_id`. You can learn more by checking out [Build Microsoft Teams apps with Microsoft Graph](https://docs.microsoft.com/en-us/graph/tutorials/teams).

```json title=JSON
{
  "message": {
    // Recipient Profile
    "to": {
      "ms_teams": {
        "user_id": "",
        "tenant_id": "",
        "service_url": "https://smba.trafficmanager.net/amer"
      }
    }
  }
}
```

### Send a message to an Microsoft Teams Channel

To deliver a message to a channel over Microsoft Teams, Courier must be provided with the ID of the channel and the service URL associated with that Microsoft Teams tenant.

To locate the `conversation_id` open Microsoft Teams in the browser and use the `threadId` query parameter from the url.

```json title=JSON
// Recipient Profile
{
  "message": {
    "to": {
      "ms_teams": {
        "conversation_id": "",
        "tenant_id": "",
        "service_url": "https://smba.trafficmanager.net/amer"
      }
    }
  }
}
```

:::info
If you are located in the Americas Region, the service url is https://smba.trafficmanager.net/amer.
:::

# Overrides

Overrides can be used to change the App ID and App Password of an Azure Bot. Below is an example of overriding the ID and password:

```json title=JSON
{
  "message": {
    "template": "<COURIER_NOTIFICATION_ID>",
    "to": {
      "ms_teams": {
        "user_id": "a-user-id",
        "tenant_id": "a-tenant-id-or-group-id",
        "service_url": "https://smba.trafficmanager.net/amer"
      }
    },
    "data": {
      "name": "Katherine Pryde"
    },
    "providers": {
      "msteams": {
        "override": {
          "config": {
            "appId": "<App ID>",
            "appPassword": "<App Password>"
          }
        }
      }
    }
  }
}
```
